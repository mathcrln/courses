(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[815],{2276:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/[slug]",function(){return t(6596)}])},1024:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var r=t(5893),i=t(1664),s=t.n(i),o=t(7294),c=t(8218);function u(e){return(0,o.useContext)(c.S).username?e.children:e.fallback||(0,r.jsx)(s(),{href:"/enter",children:"You must be signed in"})}},4866:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(5893);function i(e){return e.show?(0,r.jsx)("div",{className:"loader"}):null}},6596:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return A}});var r=t(4051),i=t.n(r),s=t(5893),o=t(713),c=t.n(o),u=t(1024),a=t(6482),l=t(7294),d=t(4866);function f(e,n,t,r,i,s,o){try{var c=e[s](o),u=c.value}catch(a){return void t(a)}c.done?n(u):Promise.resolve(u).then(r,i)}function h(){var e=(0,l.useState)(!1),n=e[0],t=e[1],r=(0,l.useState)(0),o=r[0],c=r[1],u=(0,l.useState)(null),h=u[0],p=u[1],m=function(){var e,n=(e=i().mark((function e(n){var r,s,o,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=Array.from(n.target.files)[0],o=s.type.split("/")[1],u=a.tO.ref("uploads/".concat(null===a.I8||void 0===a.I8||null===(r=a.I8.currentUser)||void 0===r?void 0:r.uid,"/").concat(Date.now(),".").concat(o)),t(!0),(l=u.put(s)).on(a.mC,(function(e){var n=(e.bytesTransferred/e.totalBytes*100).toFixed(0);c(n)})),l.then((function(e){return u.getDownloadURL()})).then((function(e){p(e),t(!1)}));case 8:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var s=e.apply(n,t);function o(e){f(s,r,i,o,c,"next",e)}function c(e){f(s,r,i,o,c,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}();return(0,s.jsxs)("div",{className:"box",children:[(0,s.jsx)(d.Z,{show:n}),n&&(0,s.jsxs)("h3",{children:[o,"%"]}),!n&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("label",{className:"btn",children:["\ud83d\udcf8 Upload Img",(0,s.jsx)("input",{type:"file",onChange:m,accept:"image/x-png,image/gif,image/jpeg"})]})}),h&&(0,s.jsx)("code",{className:"upload-snippet",children:"![alt](".concat(h,")")})]})}var p=t(1163),m=t(6677),v=t(2283),x=t(724),b=t.n(x),j=t(1664),y=t.n(j),g=t(4931);function w(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function _(e,n,t,r,i,s,o){try{var c=e[s](o),u=c.value}catch(a){return void t(a)}c.done?n(u):Promise.resolve(u).then(r,i)}function N(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var s=e.apply(n,t);function o(e){_(s,r,i,o,c,"next",e)}function c(e){_(s,r,i,o,c,"throw",e)}o(void 0)}))}}function k(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,s=[],o=!0,c=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(s.push(r.value),!n||s.length!==n);o=!0);}catch(u){c=!0,i=u}finally{try{o||null==t.return||t.return()}finally{if(c)throw i}}return s}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return w(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return w(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(){return(0,s.jsx)(u.Z,{children:(0,s.jsx)(S,{})})}function S(){var e,n=(0,l.useState)(!1),t=n[0],r=n[1],i=(0,p.useRouter)().query.slug,o=a.RZ.collection("users").doc(null===a.I8||void 0===a.I8||null===(e=a.I8.currentUser)||void 0===e?void 0:e.uid).collection("posts").doc(i),u=k((0,m.iY)(o),1)[0];return(0,s.jsx)("main",{className:c().container,children:u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("section",{children:[(0,s.jsx)("h1",{children:u.title}),(0,s.jsxs)("p",{children:["ID: ",u.slug]}),(0,s.jsx)(I,{postRef:o,defaultValues:u,preview:t})]}),(0,s.jsxs)("aside",{children:[(0,s.jsx)("h3",{children:"Tools"}),(0,s.jsx)("button",{onClick:function(){return r(!t)},children:t?"Edit":"Preview"}),(0,s.jsx)(y(),{href:"/".concat(u.username,"/").concat(u.slug),children:(0,s.jsx)("button",{className:"btn-blue",children:"Live view"})}),(0,s.jsx)(P,{postRef:o})]})]})})}function I(e){var n=e.defaultValues,t=e.postRef,r=e.preview,o=(0,v.cI)({defaultValues:n,mode:"onChange"}),u=o.register,l=o.errors,d=o.handleSubmit,f=o.formState,p=o.reset,m=o.watch,x=f.isValid,j=f.isDirty,y=function(){var e=N(i().mark((function e(n){var r,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.content,s=n.published,e.next=3,t.update({content:r,published:s,updatedAt:(0,a.Bt)()});case 3:p({content:r,published:s}),g.ZP.success("Post updated successfully!");case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,s.jsxs)("form",{onSubmit:d(y),children:[r&&(0,s.jsx)("div",{className:"card",children:(0,s.jsx)(b(),{children:m("content")})}),(0,s.jsxs)("div",{className:r?c().hidden:c().controls,children:[(0,s.jsx)(h,{}),(0,s.jsx)("textarea",{name:"content",ref:u({maxLength:{value:2e4,message:"content is too long"},minLength:{value:10,message:"content is too short"},required:{value:!0,message:"content is required"}})}),l.content&&(0,s.jsx)("p",{className:"text-danger",children:l.content.message}),(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("input",{className:c().checkbox,name:"published",type:"checkbox",ref:u}),(0,s.jsx)("label",{children:"Published"})]}),(0,s.jsx)("button",{type:"submit",className:"btn-green",disabled:j||!x,children:"Save Changes"})]})]})}function P(e){var n=e.postRef,t=(0,p.useRouter)(),r=function(){var e=N(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!confirm("are you sure!")){e.next=6;break}return e.next=4,n.delete();case 4:t.push("/admin"),(0,g.ZP)("post annihilated ",{icon:"\ud83d\uddd1\ufe0f"});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.jsx)("button",{className:"btn-red",onClick:r,children:"Delete"})}},713:function(e){e.exports={container:"Admin_container__7Kd1y",hidden:"Admin_hidden__blWKt",controls:"Admin_controls__RhTAv",input:"Admin_input__9_7r7",checkbox:"Admin_checkbox__Ttf_p"}}},function(e){e.O(0,[963,283,774,888,179],(function(){return n=2276,e(e.s=n);var n}));var n=e.O();_N_E=n}]);